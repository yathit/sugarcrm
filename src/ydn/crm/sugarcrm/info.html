<html>
<head>
    <title>SugarCRM info</title>
</head>
<body>
<div id="modules"></div>
<script type="text/javascript" src="info.js"></script>
<script type="text/javascript">

var log = function(s) {
    console.log(s);
    if ('string' == typeof s) {
        var d = document.createElement('div');
        d.textContent = s;
        document.body.appendChild(d);
    } else {
        var tx = document.createElement('textarea');
        tx.value = JSON.stringify(s, null, 2);
        document.body.appendChild(tx);
    }

};

var listModules = function () {
    moduleLists.modules.map(function (x) {
        // log(x.module_key);
        var d = document.createElement('details');
        var s = document.createElement('summary');
        var c = document.createElement('div');
        s.textContent = x.module_key;
        createFields(c, x.module_key);
        d.appendChild(s);
        d.appendChild(c);
        document.body.appendChild(d);
    });
};

var listFields = function (module_name) {
    sugarCrmModuleInfos.map(function (x) {
        if (x.module_name == module_name) {
            for (var f in x.module_fields) {
                log(f + ' (' + x.module_fields[f].type + ')');
            }
        }
    });
};

var createFields = function (div, module_name) {
    sugarCrmModuleInfos.map(function (x) {
        if (x.module_name == module_name) {
            var fg = document.createDocumentFragment();
            for (var f in x.module_fields) {
                var d = document.createElement('div');
                var gp = x.module_fields[f].group ? ' [' + x.module_fields[f].group + ']' : '';
                d.textContent = f + ' (' + x.module_fields[f].type + ')' + gp;
                fg.appendChild(d);
            }
            div.appendChild(fg);
        }
    });
};

var listLinks = function (module_name) {
    sugarCrmModuleInfos.map(function (x) {
        if (x.module_name == module_name) {

            for (var f in x.link_fields) {
                var link = x.link_fields[f];
                log(f + ': ' + link.relationship);
            }
        }
    });
};
</script>

<button onclick="listModules();">List modules</button>
</body>
</html>

